function addAPITag(){var a=document.createElement("script");a.src="https://www.youtube.com/iframe_api";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}function onYouTubeIframeAPIReady(){var a=new YT.Player("player",{height:"566",width:"960",videoId:getURLParams().v,events:{onReady:onPlayerReady,onStateChange:onPlayerStateChange}});$("loop-times").addEventListener("submit",updateTimes(a))}function $(a){return document.getElementById(a)}function onPlayerReady(a){a.target.playVideo();var b=getURLParams();if(b.startTime){$("startTime").value=b.startTime}if(b.endTime){$("endTime").value=b.endTime}setInterval(videoTick(a.target),150)}var initEndTime=false;function onPlayerStateChange(a){if(a.data==YT.PlayerState.PLAYING&&!initEndTime){if($("endTime").value=="0:00"){$("endTime").value=secondsToTime(a.target.getDuration())}else{$("endTime").value=secondsToTime(timeToSeconds($("endTime").value))}initEndTime=true;updateTimes(a.target)}}function videoTick(a){return function(){var c=a.getCurrentTime();var b=timeToSeconds($("endTime").value);var d=timeToSeconds($("startTime").value);if(c>=b&&b>d){a.seekTo(d,true)}}}function updateTimes(a){return function(){var g=getURLParams().v;var f=secondsToTime(timeToSeconds($("startTime").value));var c=secondsToTime(timeToSeconds($("endTime").value));$("startTime").value=f;$("endTime").value=c;a.seekTo(timeToSeconds(f),true);var e="http://www.youtubeencore.com/watch?v="+g+"&startTime="+f+"&endTime="+c;var d=Math.ceil(e.length/18);var b=qrcode(d,"M");b.addData(e);b.make();b.drawOnCanvas($("qrcanvas"))}}function secondsToTime(b){var a=Math.floor(b/60);var c=Math.floor((b-a*60)*100)/100;if(c<10){c="0"+c}return a+":"+c}function timeToSeconds(a){var b=a.indexOf(":");return a.slice(0,b)*60+a.slice(b+1)*1}function getURLParams(){var a=window.location.search.substr(1);var c=a.split("&");var e={};for(var b=0;b<c.length;b++){var d=c[b].split("=");e[d[0]]=d[1]}return e}addAPITag();