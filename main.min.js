function addAPITag(){var a=document.createElement("script");a.src="https://www.youtube.com/iframe_api";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}function onYouTubeIframeAPIReady(){var a=new YT.Player("player",{height:"566",width:"960",videoId:getURLParams().v,events:{onReady:onPlayerReady}});$("loop-times").addEventListener("submit",updateTimes(a));$("reset-times").addEventListener("click",function(){resetTimes(a);updateTimes(a)()});$("loop-set-start").addEventListener("click",function(){var b=a.getCurrentTime();$("startTime").value=secondsToTime(b)});$("loop-set-end").addEventListener("click",function(){var b=a.getCurrentTime();$("endTime").value=secondsToTime(b)});$("qr-button").addEventListener("click",function(){updateQRCode();$("qrcontainer").style.opacity=1;$("qrcontainer").style.visibility="visible"});$("qrcontainer").addEventListener("click",function(){if($("qrcontainer").style.visibility=="visible"){$("qrcontainer").style.opacity=0;$("qrcontainer").style.visibility="hidden"}});updateTimes(a)()}function resetTimes(a){var b=getURLParams();if(b.startTime){$("startTime").value=b.startTime}else{$("startTime").value=secondsToTime(0)}if(b.endTime){$("endTime").value=b.endTime}else{$("endTime").value=secondsToTime(a.getDuration())}}function startLoop(a){var b=timeToSeconds($("startTime").value);if(a.seekTo){a.seekTo(b,true)}}function $(a){return document.getElementById(a)}function onPlayerReady(a){a.target.playVideo();resetTimes(a.target);setInterval(videoTick(a.target),150)}function videoTick(a){return function(){var c=a.getCurrentTime();var b=timeToSeconds($("endTime").value);var d=timeToSeconds($("startTime").value);if(c>=b&&b>d){startLoop(a)}if(b>a.getDuration()){$("endTime").value=secondsToTime(a.getDuration())}if(d>=b||d<0){$("startTime").value=0}}}function updateTimes(a){return function(){var c=timeToSeconds($("startTime").value);var b=timeToSeconds($("endTime").value);var d=86400;if(a.getDuration){d=a.getDuration()}if(c<0||c>=d){c=0}$("startTime").value=secondsToTime(c);if(b<=c||b>d){b=d}$("endTime").value=secondsToTime(b);startLoop(a)}}function updateQRCode(){var f=getURLParams().v;var e=timeToSeconds($("startTime").value);var b=timeToSeconds($("endTime").value);var d="https://www.youtubeencore.com/watch?v="+f+"&startTime="+secondsToTime(e)+"&endTime="+secondsToTime(b);var c=Math.ceil(d.length/18);var a=qrcode(c,"M");a.addData(d);a.make();a.drawOnCanvas($("qrcanvas"),8)}function secondsToTime(b){var a=Math.floor(b/60);var c=Math.floor((b-a*60)*100)/100;if(c<10){c="0"+c}return a+":"+c}function timeToSeconds(a){var b=a.indexOf(":");if(b>-1){return a.slice(0,b)*60+a.slice(b+1)*1}return a*1}function getURLParams(){var a=window.location.search.substr(1);var c=a.split("&");var e={};for(var b=0;b<c.length;b++){var d=c[b].split("=");e[d[0]]=d[1]}return e}addAPITag();