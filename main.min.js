function addAPITag(){var a=document.createElement("script");a.src="https://www.youtube.com/iframe_api";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}function onYouTubeIframeAPIReady(){var a=new YT.Player("player",{height:"566",width:"960",videoId:getURLParams().v,events:{onReady:onPlayerReady}});$("loop-times").addEventListener("submit",updateTimes(a));$("reset-times").addEventListener("click",function(){resetTimes(a);startLoop(a)});var b=updateTimes(a);b()}function resetTimes(a){var b=getURLParams();if(b.startTime){$("startTime").value=b.startTime}else{$("startTime").value=secondsToTime(0)}if(b.endTime){$("endTime").value=b.endTime}else{$("endTime").value=secondsToTime(a.getDuration())}}function startLoop(a){var b=timeToSeconds($("startTime").value);if(a.seekTo){a.seekTo(b,true)}}function $(a){return document.getElementById(a)}function onPlayerReady(a){a.target.playVideo();resetTimes(a.target);setInterval(videoTick(a.target),150)}function videoTick(a){return function(){var c=a.getCurrentTime();var b=timeToSeconds($("endTime").value);var d=timeToSeconds($("startTime").value);if(c>=b&&b>d&&d<a.getDuration()){startLoop(a)}}}function updateTimes(a){return function(){var g=getURLParams().v;var f=timeToSeconds($("startTime").value);var c=timeToSeconds($("endTime").value);var h=86400;if(a.getDuration){h=a.getDuration()}if(f<0||f>=h){f=0}$("startTime").value=secondsToTime(f);if(c<=f||c>h){c=h}$("endTime").value=secondsToTime(c);startLoop(a);var e="http://www.youtubeencore.com/watch?v="+g+"&startTime="+secondsToTime(f)+"&endTime="+secondsToTime(c);var d=Math.ceil(e.length/18);var b=qrcode(d,"M");b.addData(e);b.make();b.drawOnCanvas($("qrcanvas"))}}function secondsToTime(b){var a=Math.floor(b/60);var c=Math.floor((b-a*60)*100)/100;if(c<10){c="0"+c}return a+":"+c}function timeToSeconds(a){var b=a.indexOf(":");return a.slice(0,b)*60+a.slice(b+1)*1}function getURLParams(){var a=window.location.search.substr(1);var c=a.split("&");var e={};for(var b=0;b<c.length;b++){var d=c[b].split("=");e[d[0]]=d[1]}return e}addAPITag();